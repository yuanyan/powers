require=(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
var React = require('react');
var ReactDOM = require('react-dom');

var selfCleaningTimeout = {
    componentDidUpdate: function() {
        clearTimeout(this.timeoutID);
    },
    setTimeout: function() {
        clearTimeout(this.timeoutID);
        this.timeoutID = setTimeout.apply(null, arguments);
    }
};

var ComponentPreview = React.createClass({displayName: "ComponentPreview",
    propTypes: {
        code: React.PropTypes.string.isRequired
    },

    mixins: [selfCleaningTimeout],

    render: function() {
        return React.createElement("div", {ref: "mount"});
    },

    componentDidMount: function() {
        this.executeCode();
    },

    componentDidUpdate: function(prevProps) {
        // execute code only when the state's not being updated by switching tab
        // this avoids re-displaying the error, which comes after a certain delay
        if (this.props.code !== prevProps.code) {
            this.executeCode();
        }
    },

    compileCode: function() {
        return JSXTransformer.transform(
                '(function() {' +
                this.props.code +
                '\n})();',
            { harmony: true }
        ).code;
    },

    executeCode: function() {
        var mountNode = this.refs.mount;

        try {
            ReactDOM.unmountComponentAtNode(mountNode);
        } catch (e) { }

        try {
            var compiledCode = this.compileCode();
            ReactDOM.render(eval(compiledCode), mountNode);
        } catch (err) {

            this.setTimeout(function() {
                ReactDOM.render(
                    React.createElement("div", {className: "playgroundError"},  err.stack || err.toString()),
                    mountNode
                );
            }, 500);
        }
    }
});

var IS_MOBILE = (
    navigator.userAgent.match(/Android/i)
    || navigator.userAgent.match(/webOS/i)
    || navigator.userAgent.match(/iPhone/i)
    || navigator.userAgent.match(/iPad/i)
    || navigator.userAgent.match(/iPod/i)
    || navigator.userAgent.match(/BlackBerry/i)
    || navigator.userAgent.match(/Windows Phone/i)
    );

var CodeMirrorEditor = React.createClass({displayName: "CodeMirrorEditor",
    componentDidMount: function() {
        if (IS_MOBILE) return;

        this.editor = CodeMirror.fromTextArea(this.refs.editor, {
            mode: 'javascript',
            //lineNumbers: true,
            viewportMargin: Infinity,
            lineWrapping: true,
            smartIndent: false,  // javascript mode does bad things with jsx indents
            matchBrackets: true,
            readOnly: this.props.readOnly
        });
        this.editor.on('change', this.handleChange);
    },

    componentDidUpdate: function() {
        if (this.props.readOnly) {
            this.editor.setValue(this.props.codeText);
        }
    },

    handleChange: function() {
        if (!this.props.readOnly && this.props.onChange) {
            this.props.onChange(this.editor.getValue());
        }
    },

    render: function() {
        // wrap in a div to fully contain CodeMirror
        var editor;

        if (IS_MOBILE) {
            editor = React.createElement("pre", {style: {overflow: 'scroll'}}, this.props.codeText);
        } else {
            editor = React.createElement("textarea", {ref: "editor", defaultValue: this.props.codeText});
        }

        return (
            React.createElement("div", {style: this.props.style, className: this.props.className}, 
            editor
            )
            );
    }
});

var ReactPlayground = React.createClass({displayName: "ReactPlayground",
    propTypes: {
        codeText: React.PropTypes.string.isRequired
    },

    getInitialState: function() {
        return {
            code: this.props.codeText
        };
    },

    handleCodeChange: function(code) {
        this.setState({
            code: code
        });
    },

    changeTab: function(){
        if(this.state.tab == 'preview')
            this.setState({
                tab: 'edit'
            })
        else
            this.setState({
                tab: 'preview'
            })
    },

    render: function() {

        var tabText = this.state.tab == 'preview'? 'Live Preview': 'Live Edit';
        var code = React.createElement("div", {className: "playgroundCode"}, 
            React.createElement(CodeMirrorEditor, {key: "jsx", 
            onChange: this.handleCodeChange, 
            className: "playgroundStage", 
            codeText: this.state.code})
        );

        var preview = React.createElement("div", {className: "playgroundPreview"}, 
            React.createElement(ComponentPreview, {code: this.state.code})
        )

        return (
         React.createElement("div", {className: "playground"}, 
            React.createElement("div", {className: "playgroundTab", onClick: this.changeTab}, React.createElement("span", {className: "blur"}, tabText)), 
            this.state.tab == 'preview'? code: preview
         )
      );
    }
});

for(var id=1; id<10; id++){
    var example = document.getElementById('example'+id);
    if(example){
        ReactDOM.render(
            React.createElement(ReactPlayground, {codeText: document.getElementById('code'+id).innerHTML}),
            example
        );
    }
}

},{"react":undefined,"react-dom":undefined}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCIvVXNlcnMveWl6aS9jb2RlL2Jvcm9uL2V4YW1wbGUvc3JjL2FwcC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBLElBQUksS0FBSyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQztBQUM3QixJQUFJLFFBQVEsR0FBRyxPQUFPLENBQUMsV0FBVyxDQUFDLENBQUM7O0FBRXBDLElBQUksbUJBQW1CLEdBQUc7SUFDdEIsa0JBQWtCLEVBQUUsV0FBVztRQUMzQixZQUFZLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO0tBQ2hDO0lBQ0QsVUFBVSxFQUFFLFdBQVc7UUFDbkIsWUFBWSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUM3QixJQUFJLENBQUMsU0FBUyxHQUFHLFVBQVUsQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLFNBQVMsQ0FBQyxDQUFDO0tBQ3REO0FBQ0wsQ0FBQyxDQUFDOztBQUVGLElBQUksc0NBQXNDLGdDQUFBO0lBQ3RDLFNBQVMsRUFBRTtRQUNQLElBQUksRUFBRSxLQUFLLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxVQUFVO0FBQy9DLEtBQUs7O0FBRUwsSUFBSSxNQUFNLEVBQUUsQ0FBQyxtQkFBbUIsQ0FBQzs7SUFFN0IsTUFBTSxFQUFFLFdBQVc7UUFDZixPQUFPLG9CQUFBLEtBQUksRUFBQSxDQUFBLENBQUMsR0FBQSxFQUFHLENBQUMsT0FBTyxDQUFBLENBQUcsQ0FBQSxDQUFDO0FBQ25DLEtBQUs7O0lBRUQsaUJBQWlCLEVBQUUsV0FBVztRQUMxQixJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7QUFDM0IsS0FBSzs7QUFFTCxJQUFJLGtCQUFrQixFQUFFLFNBQVMsU0FBUyxFQUFFO0FBQzVDOztRQUVRLElBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLEtBQUssU0FBUyxDQUFDLElBQUksRUFBRTtZQUNwQyxJ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QUFTLENBQUMsZUFBQSxFQUFlLENBQUMsT0FBQSxFQUFPLENBQUUsSUFBSSxDQUFDLFNBQVcsQ0FBQSxFQUFBLG9CQUFBLE1BQUssRUFBQSxDQUFBLENBQUMsU0FBQSxFQUFTLENBQUMsTUFBTyxDQUFBLEVBQUMsT0FBZSxDQUFNLENBQUEsRUFBQTtZQUNwRyxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsSUFBSSxTQUFTLEVBQUUsSUFBSSxFQUFFLE9BQVE7U0FDekMsQ0FBQTtRQUNQO0tBQ0g7QUFDTCxDQUFDLENBQUMsQ0FBQzs7QUFFSCxJQUFJLElBQUksRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsRUFBRSxDQUFDO0lBQ3RCLElBQUksT0FBTyxHQUFHLFFBQVEsQ0FBQyxjQUFjLENBQUMsU0FBUyxDQUFDLEVBQUUsQ0FBQyxDQUFDO0lBQ3BELEdBQUcsT0FBTyxDQUFDO1FBQ1AsUUFBUSxDQUFDLE1BQU07WUFDWCxvQkFBQyxlQUFlLEVBQUEsQ0FBQSxDQUFDLFFBQUEsRUFBUSxDQUFFLFFBQVEsQ0FBQyxjQUFjLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxDQUFDLFNBQVUsQ0FBQSxDQUFHLENBQUE7WUFDM0UsT0FBTztTQUNWLENBQUM7S0FDTDtDQUNKIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsInZhciBSZWFjdCA9IHJlcXVpcmUoJ3JlYWN0Jyk7XG52YXIgUmVhY3RET00gPSByZXF1aXJlKCdyZWFjdC1kb20nKTtcblxudmFyIHNlbGZDbGVhbmluZ1RpbWVvdXQgPSB7XG4gICAgY29tcG9uZW50RGlkVXBkYXRlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZW91dElEKTtcbiAgICB9LFxuICAgIHNldFRpbWVvdXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lb3V0SUQpO1xuICAgICAgICB0aGlzLnRpbWVvdXRJRCA9IHNldFRpbWVvdXQuYXBwbHkobnVsbCwgYXJndW1lbnRzKTtcbiAgICB9XG59O1xuXG52YXIgQ29tcG9uZW50UHJldmlldyA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcbiAgICBwcm9wVHlwZXM6IHtcbiAgICAgICAgY29kZTogUmVhY3QuUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkXG4gICAgfSxcblxuICAgIG1peGluczogW3NlbGZDbGVhbmluZ1RpbWVvdXRdLFxuXG4gICAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIDxkaXYgcmVmPVwibW91bnRcIiAvPjtcbiAgICB9LFxuXG4gICAgY29tcG9uZW50RGlkTW91bnQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLmV4ZWN1dGVDb2RlKCk7XG4gICAgfSxcblxuICAgIGNvbXBvbmVudERpZFVwZGF0ZTogZnVuY3Rpb24ocHJldlByb3BzKSB7XG4gICAgICAgIC8vIGV4ZWN1dGUgY29kZSBvbmx5IHdoZW4gdGhlIHN0YXRlJ3Mgbm90IGJlaW5nIHVwZGF0ZWQgYnkgc3dpdGNoaW5nIHRhYlxuICAgICAgICAvLyB0aGlzIGF2b2lkcyByZS1kaXNwbGF5aW5nIHRoZSBlcnJvciwgd2hpY2ggY29tZXMgYWZ0ZXIgYSBjZXJ0YWluIGRlbGF5XG4gICAgICAgIGlmICh0aGlzLnByb3BzLmNvZGUgIT09IHByZXZQcm9wcy5jb2RlKSB7XG4gICAgICAgICAgICB0aGlzLmV4ZWN1dGVDb2RlKCk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgY29tcGlsZUNvZGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gSlNYVHJhbnNmb3JtZXIudHJhbnNmb3JtKFxuICAgICAgICAgICAgICAgICcoZnVuY3Rpb24oKSB7JyArXG4gICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5jb2RlICtcbiAgICAgICAgICAgICAgICAnXFxufSkoKTsnLFxuICAgICAgICAgICAgeyBoYXJtb255OiB0cnVlIH1cbiAgICAgICAgKS5jb2RlO1xuICAgIH0sXG5cbiAgICBleGVjdXRlQ29kZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBtb3VudE5vZGUgPSB0aGlzLnJlZnMubW91bnQ7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIFJlYWN0RE9NLnVubW91bnRDb21wb25lbnRBdE5vZGUobW91bnROb2RlKTtcbiAgICAgICAgfSBjYXRjaCAoZSkgeyB9XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHZhciBjb21waWxlZENvZGUgPSB0aGlzLmNvbXBpbGVDb2RlKCk7XG4gICAgICAgICAgICBSZWFjdERPTS5yZW5kZXIoZXZhbChjb21waWxlZENvZGUpLCBtb3VudE5vZGUpO1xuICAgICAgICB9IGNhdGNoIChlcnIpIHtcblxuICAgICAgICAgICAgdGhpcy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIFJlYWN0RE9NLnJlbmRlcihcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJwbGF5Z3JvdW5kRXJyb3JcIj57IGVyci5zdGFjayB8fCBlcnIudG9TdHJpbmcoKSB9PC9kaXY+LFxuICAgICAgICAgICAgICAgICAgICBtb3VudE5vZGVcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSwgNTAwKTtcbiAgICAgICAgfVxuICAgIH1cbn0pO1xuXG52YXIgSVNfTU9CSUxFID0gKFxuICAgIG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL0FuZHJvaWQvaSlcbiAgICB8fCBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC93ZWJPUy9pKVxuICAgIHx8IG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL2lQaG9uZS9pKVxuICAgIHx8IG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL2lQYWQvaSlcbiAgICB8fCBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9pUG9kL2kpXG4gICAgfHwgbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvQmxhY2tCZXJyeS9pKVxuICAgIHx8IG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL1dpbmRvd3MgUGhvbmUvaSlcbiAgICApO1xuXG52YXIgQ29kZU1pcnJvckVkaXRvciA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcbiAgICBjb21wb25lbnREaWRNb3VudDogZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmIChJU19NT0JJTEUpIHJldHVybjtcblxuICAgICAgICB0aGlzLmVkaXRvciA9IENvZGVNaXJyb3IuZnJvbVRleHRBcmVhKHRoaXMucmVmcy5lZGl0b3IsIHtcbiAgICAgICAgICAgIG1vZGU6ICdqYXZhc2NyaXB0JyxcbiAgICAgICAgICAgIC8vbGluZU51bWJlcnM6IHRydWUsXG4gICAgICAgICAgICB2aWV3cG9ydE1hcmdpbjogSW5maW5pdHksXG4gICAgICAgICAgICBsaW5lV3JhcHBpbmc6IHRydWUsXG4gICAgICAgICAgICBzbWFydEluZGVudDogZmFsc2UsICAvLyBqYXZhc2NyaXB0IG1vZGUgZG9lcyBiYWQgdGhpbmdzIHdpdGgganN4IGluZGVudHNcbiAgICAgICAgICAgIG1hdGNoQnJhY2tldHM6IHRydWUsXG4gICAgICAgICAgICByZWFkT25seTogdGhpcy5wcm9wcy5yZWFkT25seVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5lZGl0b3Iub24oJ2NoYW5nZScsIHRoaXMuaGFuZGxlQ2hhbmdlKTtcbiAgICB9LFxuXG4gICAgY29tcG9uZW50RGlkVXBkYXRlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHRoaXMucHJvcHMucmVhZE9ubHkpIHtcbiAgICAgICAgICAgIHRoaXMuZWRpdG9yLnNldFZhbHVlKHRoaXMucHJvcHMuY29kZVRleHQpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIGhhbmRsZUNoYW5nZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICghdGhpcy5wcm9wcy5yZWFkT25seSAmJiB0aGlzLnByb3BzLm9uQ2hhbmdlKSB7XG4gICAgICAgICAgICB0aGlzLnByb3BzLm9uQ2hhbmdlKHRoaXMuZWRpdG9yLmdldFZhbHVlKCkpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIHdyYXAgaW4gYSBkaXYgdG8gZnVsbHkgY29udGFpbiBDb2RlTWlycm9yXG4gICAgICAgIHZhciBlZGl0b3I7XG5cbiAgICAgICAgaWYgKElTX01PQklMRSkge1xuICAgICAgICAgICAgZWRpdG9yID0gPHByZSBzdHlsZT17e292ZXJmbG93OiAnc2Nyb2xsJ319Pnt0aGlzLnByb3BzLmNvZGVUZXh0fTwvcHJlPjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGVkaXRvciA9IDx0ZXh0YXJlYSByZWY9XCJlZGl0b3JcIiBkZWZhdWx0VmFsdWU9e3RoaXMucHJvcHMuY29kZVRleHR9IC8+O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxkaXYgc3R5bGU9e3RoaXMucHJvcHMuc3R5bGV9IGNsYXNzTmFtZT17dGhpcy5wcm9wcy5jbGFzc05hbWV9PlxuICAgICAgICAgICAge2VkaXRvcn1cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgKTtcbiAgICB9XG59KTtcblxudmFyIFJlYWN0UGxheWdyb3VuZCA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcbiAgICBwcm9wVHlwZXM6IHtcbiAgICAgICAgY29kZVRleHQ6IFJlYWN0LlByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZFxuICAgIH0sXG5cbiAgICBnZXRJbml0aWFsU3RhdGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgY29kZTogdGhpcy5wcm9wcy5jb2RlVGV4dFxuICAgICAgICB9O1xuICAgIH0sXG5cbiAgICBoYW5kbGVDb2RlQ2hhbmdlOiBmdW5jdGlvbihjb2RlKSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgY29kZTogY29kZVxuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgY2hhbmdlVGFiOiBmdW5jdGlvbigpe1xuICAgICAgICBpZih0aGlzLnN0YXRlLnRhYiA9PSAncHJldmlldycpXG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICB0YWI6ICdlZGl0J1xuICAgICAgICAgICAgfSlcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgdGFiOiAncHJldmlldydcbiAgICAgICAgICAgIH0pXG4gICAgfSxcblxuICAgIHJlbmRlcjogZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgdmFyIHRhYlRleHQgPSB0aGlzLnN0YXRlLnRhYiA9PSAncHJldmlldyc/ICdMaXZlIFByZXZpZXcnOiAnTGl2ZSBFZGl0JztcbiAgICAgICAgdmFyIGNvZGUgPSA8ZGl2IGNsYXNzTmFtZT1cInBsYXlncm91bmRDb2RlXCI+XG4gICAgICAgICAgICA8Q29kZU1pcnJvckVkaXRvciBrZXk9XCJqc3hcIlxuICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMuaGFuZGxlQ29kZUNoYW5nZX1cbiAgICAgICAgICAgIGNsYXNzTmFtZT1cInBsYXlncm91bmRTdGFnZVwiXG4gICAgICAgICAgICBjb2RlVGV4dD17dGhpcy5zdGF0ZS5jb2RlfSAvPlxuICAgICAgICA8L2Rpdj47XG5cbiAgICAgICAgdmFyIHByZXZpZXcgPSA8ZGl2IGNsYXNzTmFtZT1cInBsYXlncm91bmRQcmV2aWV3XCI+XG4gICAgICAgICAgICA8Q29tcG9uZW50UHJldmlldyBjb2RlPXt0aGlzLnN0YXRlLmNvZGV9IC8+XG4gICAgICAgIDwvZGl2PlxuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInBsYXlncm91bmRcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicGxheWdyb3VuZFRhYlwiIG9uQ2xpY2s9e3RoaXMuY2hhbmdlVGFifT48c3BhbiBjbGFzc05hbWU9XCJibHVyXCI+e3RhYlRleHR9PC9zcGFuPjwvZGl2PlxuICAgICAgICAgICAge3RoaXMuc3RhdGUudGFiID09ICdwcmV2aWV3Jz8gY29kZTogcHJldmlld31cbiAgICAgICAgIDwvZGl2PlxuICAgICAgKTtcbiAgICB9XG59KTtcblxuZm9yKHZhciBpZD0xOyBpZDwxMDsgaWQrKyl7XG4gICAgdmFyIGV4YW1wbGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXhhbXBsZScraWQpO1xuICAgIGlmKGV4YW1wbGUpe1xuICAgICAgICBSZWFjdERPTS5yZW5kZXIoXG4gICAgICAgICAgICA8UmVhY3RQbGF5Z3JvdW5kIGNvZGVUZXh0PXtkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29kZScraWQpLmlubmVySFRNTH0gLz4sXG4gICAgICAgICAgICBleGFtcGxlXG4gICAgICAgICk7XG4gICAgfVxufVxuIl19
